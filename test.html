<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>ì„¸ë ¨ëœ ë°©ëª…ë¡</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--glass:rgba(255,255,255,0.06);--accent:#6ee7b7;--muted:rgba(255,255,255,0.6)}
    *{box-sizing:border-box}html,body{height:100%}
    body{
      margin:0;font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans KR",sans-serif;
      background: radial-gradient(1200px 600px at 10% 10%, rgba(99,102,241,0.12), transparent 8%),
                  radial-gradient(900px 400px at 90% 90%, rgba(34,197,94,0.06), transparent 8%),
                  linear-gradient(180deg,#071023 0%, #071826 100%);
      color:#e6eef8; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
      padding:48px 20px;
      display:flex;align-items:flex-start;justify-content:center;
    }

    .wrap{width:1100px;max-width:100%;display:grid;grid-template-columns:420px 1fr;gap:28px;align-items:start}

    header{grid-column:1/3;display:flex;align-items:center;gap:18px}
    .logo{width:64px;height:64px;border-radius:12px;background:linear-gradient(135deg,var(--accent),#60a5fa);display:grid;place-items:center;font-weight:700;color:#042017;box-shadow:0 8px 30px rgba(2,6,23,0.6)}
    h1{margin:0;font-size:20px}
    p.lead{margin:0;color:var(--muted);font-size:13px}

    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:14px;padding:20px;box-shadow:0 6px 30px rgba(2,6,23,0.6);backdrop-filter:blur(6px);border:1px solid rgba(255,255,255,0.03)}

    form .row{display:flex;gap:10px}
    label{display:block;font-size:13px;color:var(--muted);margin-bottom:8px}
    input[type=text], input[type=password], textarea{width:100%;padding:12px 14px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit;font-size:14px;resize:vertical}
    textarea{min-height:110px}

    .btn{display:inline-block;padding:10px 14px;border-radius:10px;background:linear-gradient(90deg,var(--accent),#60a5fa);color:#02211a;font-weight:700;border:none;cursor:pointer;box-shadow:0 6px 18px rgba(59,130,246,0.12);transition:transform .12s ease}
    .btn:active{transform:translateY(1px)}

    .meta{display:flex;gap:10px;align-items:center;font-size:13px;color:var(--muted)}

    /* message list */
    .list-ctrls{display:flex;gap:10px;align-items:center;margin-bottom:12px}
    .search{flex:1;display:flex;gap:8px}
    .search input{padding:10px 12px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}

    .messages{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:14px}
    .msg{padding:14px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.03)}
    .msg .top{display:flex;justify-content:space-between;align-items:center}
    .author{font-weight:700}
    .time{font-size:12px;color:var(--muted)}
    .content{margin-top:10px;white-space:pre-wrap;color:#dce9f6}
    .msg .actions{display:flex;gap:8px;margin-top:12px}
    .action{font-size:13px;padding:6px 8px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:var(--muted);cursor:pointer}

    .empty{padding:36px;text-align:center;color:var(--muted)}

    /* responsive */
    @media (max-width:980px){.wrap{grid-template-columns:1fr;}.list-ctrls{flex-direction:column;align-items:stretch}.logo{display:none}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">GB</div>
      <div>
        <h1>ì„¸ë ¨ëœ ë°©ëª…ë¡</h1>
        <p class="lead">ë°©ëª…ë¡ì— ë§ˆìŒì„ ë‚¨ê²¨ë³´ì„¸ìš” â€” ê°„ë‹¨í•˜ê³  ë°˜ì‘í˜• ë””ìì¸, ë¡œì»¬ì—ì„œ ë°”ë¡œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
      </div>
    </header>

    <section class="card">
      <h2 style="margin-top:0">ìƒˆ ê¸€ ë‚¨ê¸°ê¸°</h2>
      <form id="guest-form">
        <div class="row" style="margin-bottom:12px">
          <div style="flex:1">
            <label>ì´ë¦„</label>
            <input type="text" name="author" id="author" placeholder="ì´ë¦„ ì…ë ¥ (í•„ìˆ˜)" required>
          </div>
          <div style="width:120px">
            <label>ë¹„ë°€ë²ˆí˜¸</label>
            <input type="password" name="password" id="password" placeholder="ì„ íƒ" >
          </div>
        </div>
        <label>ì œëª©</label>
        <input type="text" name="title" id="title" placeholder="ì§§ê³  ì¸ìƒì ì¸ ì œëª©" required>
        <label style="margin-top:12px">ë©”ì‹œì§€</label>
        <textarea name="content" id="content" placeholder="ì—¬ê¸°ì— ë°©ëª…ë¡ ë‚´ìš©ì„ ì‘ì„±í•˜ì„¸ìš”..." required></textarea>
        <div style="display:flex;justify-content:space-between;align-items:center;margin-top:12px">
          <div class="meta">ë³´ì•ˆ: ë¹„ë°€ë²ˆí˜¸ëŠ” ë¡œì»¬ì— í‰ë¬¸ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤ â€” ê³µê°œ ì„œë¹„ìŠ¤ì—ì„  ë°±ì—”ë“œ ì‚¬ìš© ê¶Œì¥</div>
          <div>
            <button class="btn" type="submit">ë“±ë¡</button>
          </div>
        </div>
      </form>

      <hr style="margin:18px 0;border:none;border-top:1px solid rgba(255,255,255,0.03)">
      <div style="display:flex;gap:8px;align-items:center;justify-content:space-between">
        <div class="meta">ì´ <span id="count">0</span>ê°œì˜ ê¸€</div>
        <div style="display:flex;gap:8px;align-items:center">
          <div class="search">
            <input id="q" placeholder="ê²€ìƒ‰ (ì´ë¦„ / ì œëª© / ë‚´ìš©)" />
            <button id="searchBtn" class="action">ê²€ìƒ‰</button>
          </div>
          <button id="clearBtn" class="action">ëª¨ë‘ ì§€ìš°ê¸°</button>
        </div>
      </div>
    </section>

    <section class="card" style="min-height:320px">
      <h2 style="margin-top:0">ë°©ëª…ë¡ ëª©ë¡</h2>
      <div id="list" class="messages"></div>
      <div id="empty" class="empty" style="display:none">ì•„ì§ ì‘ì„±ëœ ê¸€ì´ ì—†ìŠµë‹ˆë‹¤. ì²« ê¸€ì„ ë‚¨ê²¨ë³´ì„¸ìš”!</div>
    </section>
  </div>

  <script>
    // ê°„ë‹¨í•œ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ê¸°ë°˜ ë°©ëª…ë¡ ë°ëª¨
    const FORM = document.getElementById('guest-form')
    const LIST = document.getElementById('list')
    const EMPTY = document.getElementById('empty')
    const COUNT = document.getElementById('count')
    const Q = document.getElementById('q')

    function loadPosts(){
      try{
        const raw = localStorage.getItem('guest_posts')
        return raw ? JSON.parse(raw) : []
      }catch(e){return []}
    }
    function savePosts(arr){ localStorage.setItem('guest_posts', JSON.stringify(arr)) }

    function uid(){ return Date.now().toString(36) + Math.random().toString(36).slice(2,7) }

    function render(filter=''){
      const posts = loadPosts().slice().reverse()
      const filtered = posts.filter(p=>{
        if(!filter) return true
        const t = filter.toLowerCase()
        return (p.author||'').toLowerCase().includes(t) || (p.title||'').toLowerCase().includes(t) || (p.content||'').toLowerCase().includes(t)
      })
      LIST.innerHTML = ''
      if(filtered.length===0){ EMPTY.style.display='block' } else { EMPTY.style.display='none' }
      filtered.forEach(p=>{
        const el = document.createElement('article')
        el.className='msg'
        el.innerHTML = `
          <div class="top">
            <div>
              <div class="author">${escapeHtml(p.author||'ìµëª…')}</div>
              <div class="time">${new Date(p.created).toLocaleString()}</div>
            </div>
            <div style="text-align:right">
              <div style="font-weight:700">${escapeHtml(p.title||'ì œëª© ì—†ìŒ')}</div>
            </div>
          </div>
          <div class="content">${escapeHtml(p.content)}</div>
          <div class="actions">
            <button class="action" data-id="${p.id}" data-act="edit">ìˆ˜ì •</button>
            <button class="action" data-id="${p.id}" data-act="del">ì‚­ì œ</button>
          </div>
        `
        LIST.appendChild(el)
      })
      COUNT.textContent = loadPosts().length
    }

    function escapeHtml(s){ return String(s).replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;').replaceAll('\n','<br>') }

    FORM.addEventListener('submit', e=>{
      e.preventDefault()
      const author = document.getElementById('author').value.trim() || 'ìµëª…'
      const title = document.getElementById('title').value.trim() || 'ì œëª© ì—†ìŒ'
      const content = document.getElementById('content').value.trim()
      const password = document.getElementById('password').value || ''
      if(!content){ alert('ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”'); return }
      const posts = loadPosts()
      posts.push({ id: uid(), author, title, content, password, created: new Date().toISOString() })
      savePosts(posts)
      FORM.reset()
      render(Q.value)
    })

    // delegate actions: edit / delete
    LIST.addEventListener('click', e=>{
      const btn = e.target.closest('button')
      if(!btn) return
      const id = btn.dataset.id
      const act = btn.dataset.act
      if(act==='del'){
        const posts = loadPosts()
        const target = posts.find(p=>p.id===id)
        if(!target) return alert('ê¸€ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤')
        if(target.password){
          const pw = prompt('ì‚­ì œí•˜ë ¤ë©´ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”')
          if(pw===null) return
          if(pw !== target.password) return alert('ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤')
        } else {
          if(!confirm('ë¹„ë°€ë²ˆí˜¸ê°€ ì„¤ì •ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤. ì •ë§ ì‚­ì œí• ê¹Œìš”?')) return
        }
        const remain = posts.filter(p=>p.id!==id)
        savePosts(remain)
        render(Q.value)
      }
      if(act==='edit'){
        const posts = loadPosts()
        const target = posts.find(p=>p.id===id)
        if(!target) return alert('ê¸€ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤')
        if(target.password){
          const pw = prompt('ìˆ˜ì •í•˜ë ¤ë©´ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”')
          if(pw===null) return
          if(pw !== target.password) return alert('ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤')
        }
        const newContent = prompt('ìƒˆ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”', target.content)
        if(newContent===null) return
        target.content = newContent
        target.edited = new Date().toISOString()
        savePosts(posts)
        render(Q.value)
      }
    })

    document.getElementById('searchBtn').addEventListener('click', ()=> render(Q.value))
    Q.addEventListener('keydown', e=>{ if(e.key==='Enter') { e.preventDefault(); render(Q.value) } })
    document.getElementById('clearBtn').addEventListener('click', ()=>{
      if(!confirm('ë¡œì»¬ì— ì €ì¥ëœ ëª¨ë“  ë°©ëª…ë¡ì„ ì‚­ì œí•©ë‹ˆë‹¤. ê³„ì†í• ê¹Œìš”?')) return
      localStorage.removeItem('guest_posts')
      render()
    })

    // initial seed (optional) - only when empty
    if(!localStorage.getItem('guest_posts')){
      const seed = [
        {id:uid(), author:'ê´€ë¦¬ì', title:'ì‹œì‘ ì¸ì‚¬', content:'ì•ˆë…•í•˜ì„¸ìš”! ì˜ˆì˜ê²Œ ê¾¸ë¯¼ ë°©ëª…ë¡ì…ë‹ˆë‹¤. ììœ ë¡­ê²Œ ë‚¨ê²¨ë³´ì„¸ìš” ğŸ™‚', password:'', created:new Date().toISOString()},
      ]
      localStorage.setItem('guest_posts', JSON.stringify(seed))
    }

    render()
  </script>
</body>
</html>